hist(df[[col]], main = col)
}
for (col in numer){
hist(df[[col]], main = col)
}
par(mfrow = c(3,3))
for (col in numer){
hist(df[[col]], main = col)
}
for (col in numer){
hist(df[[col]], main = col)
mini <- min(df[[col]])
maxi <- max(df[[col]])
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y)
}
par(mfrow = c(3,3))
for (col in numer){
hist(df[[col]], main = col)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y)
}
par(mfrow = c(3,3))
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
par(mfrow = c(3,3))
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = as.factor(smoker),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
categ <- numer <- c()
for (name in names(df)){
if (is.numeric(df[[name]])) {
numer <- append(numer, name)
} else {
categ <- append(categ, name)
}
}
summary(df)
sum(is.na(df))
par(mfrow = c(3,3))
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
par(mfrow = c(2,3))
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
table(df$sex)
barplot(.~sex, data = tb)
tb <- table(df$sex)
barplot(.~sex, data = tb)
barplot(~sex, data = tb)
tb <- as.data.frame(table(df$sex))
barplot(~sex, data = tb)
View(tb)
barplot(Freq~Var1, data = tb)
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
barplot(Freq~Var1, data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
barplot(Freq~Var1, data = tb)
}
par(mfrow = c(3,3))
par(mfrow = c(2,4))
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
barplot(Freq~Var1, data = tb)
}
par(mfrow = c(2,4))
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
barplot(Freq~Var1, data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(Freq~col, data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(frequency~col, data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(frequency~parse(col), data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(frequency~parse(text=col), data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(frequency~eval(col), data = tb)
}
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(frequency~sym(col), data = tb)
}
par(mfrow = c(2,4))
par(mfrow = c(2,4))
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
barplot(as.formula(paste('frequency~',col)), data = tb)
}
fmla <- as.formula(paste('frequency~',col))
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, frequency)
fmla <- as.formula(paste('frequency~',col))
barplot(fmla, data = tb)
}
typeof(fmla)
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, 'frequency')
fmla <- as.formula(paste('frequency~',col))
barplot(fmla, data = tb)
}
library(pacman)
p_load(tidyverse, ROCR, ggplot2, readr, ggthemes)
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
# EDA ---------------------------------------------------------------------
str(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = as.factor(smoker),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
str(df)
categ <- numer <- c()
for (name in names(df)){
if (is.numeric(df[[name]])) {
numer <- append(numer, name)
} else {
categ <- append(categ, name)
}
}
summary(df)
sum(is.na(df))
par(mfrow = c(2,3))
for (col in numer){
hist(df[[col]], main = col, xlab = col, freq = F)
mini <- min(df[[col]], na.rm = T)
maxi <- max(df[[col]], na.rm = T)
x <- seq(mini, maxi, .001)
avg <- mean(df[[col]], na.rm = T)
std <- sd(df[[col]], na.rm = T)
y <- dnorm(x, mean = avg, sd = std)
lines(x, y, col = 'red')
}
par(mfrow = c(2,4))
for (col in categ){
tb <- as.data.frame(table(df[[col]]))
names(tb) <- c(col, 'frequency')
fmla <- as.formula(paste('frequency~',col))
barplot(fmla, data = tb)
}
#there are many imbalanced classes, for instance stroke, diabetes and the very dependent variable CHD
#do boxplots to check which predictor might have the highest potential to separate classes
par(mfrow = c(2,3))
for (col in numer){
fmla <- as.formula(paste(col,'~CHD'))
boxplot(fmla, data = df, main = col, ylab = col)
}
# ggplot(df, aes(x = CHD, y = age)) +
#   geom_boxplot(fill='grey')
#from the analysis above we see that age has a good predictive power as the median age of the patients developing CHD is much higher compared to the median of those that do not
# checking independence for categorical variables -------------------------
c2 <- V <- p_vals <- c()
for (col in categ) {
ch2 <- chisq.test(df[[col]], df$CHD)
V2 <- sqrt((ch2$statistic/sum(ch2$observed))/ch2$parameter)
c2 <- append(c2, ch2$statistic)
p_vals <- append(p_vals, ch2$p.value)
V <- append(V, V2)
}
sum_tab_cat <- as.data.frame(rbind(c2, V, p_vals))
names(sum_tab_cat) <- categ
sum_tab_cat <- select(sum_tab_cat, -CHD)
rownames(sum_tab_cat) <- c('Chi Squared', "Cramer's V", 'p-value')
c2 <- V <- p_vals <- c()
for (col in categ) {
if (col != 'CHD') {
ch2 <- chisq.test(df[[col]], df$CHD)
V2 <- sqrt((ch2$statistic/sum(ch2$observed))/ch2$parameter)
c2 <- append(c2, ch2$statistic)
p_vals <- append(p_vals, ch2$p.value)
V <- append(V, V2)
}
}
sum_tab_cat <- as.data.frame(rbind(c2, V, p_vals))
names(sum_tab_cat) <- categ
for (col in categ) {
ch2 <- chisq.test(df[[col]], df$CHD)
V2 <- sqrt((ch2$statistic/sum(ch2$observed))/ch2$parameter)
c2 <- append(c2, ch2$statistic)
p_vals <- append(p_vals, ch2$p.value)
V <- append(V, V2)
}
sum_tab_cat <- as.data.frame(rbind(c2, V, p_vals))
names(sum_tab_cat) <- categ
sum_tab_cat <- select(sum_tab_cat, -CHD)
rownames(sum_tab_cat) <- c('Chi Squared', "Cramer's V", 'p-value')
c2 <- V <- p_vals <- c()
for (col in categ) {
ch2 <- chisq.test(df[[col]], df$CHD)
V2 <- sqrt((ch2$statistic/sum(ch2$observed))/ch2$parameter)
c2 <- append(c2, ch2$statistic)
p_vals <- append(p_vals, ch2$p.value)
V <- append(V, V2)
}
sum_tab_cat <- as.data.frame(rbind(c2, V, p_vals))
names(sum_tab_cat) <- categ
sum_tab_cat <- select(sum_tab_cat, -CHD)
rownames(sum_tab_cat) <- c('Chi Squared', "Cramer's V", 'p-value')
View(sum_tab_cat)
round(sum_tab_cat)
round(sum_tab_cat, 3)
round(sum_tab_cat, 5)
round(sum_tab_cat, 2)
sum_tab_cat <- round(sum_tab_cat, 2)
install.packages('gtsummary')
library(pacman)
p_load(tidyverse, ROCR, ggplot2, readr, ggthemes, gtsummary)
tbl_summary(df)
tbl_summary(df, by = CHD)
df <- na.omit(df)
tbl_summary(df, by = CHD)
install.packages('cardx')
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = as.factor(smoker),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN), label = list(smoker = 'yes')) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = as.factor(smoker),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('no', 'yes')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('No', 'Yes')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('no', 'yes')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('no', 'yes')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('non-smoker', 'smoker')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('non-smoker', 'smoker')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
library(pacman)
p_load(tidyverse, ROCR, ggplot2, readr, ggthemes, gtsummary)
theme_gtsummary_printer()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('non-smoker', 'smoker')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
library(pacman)
p_load(tidyverse, ROCR, ggplot2, readr, ggthemes, gtsummary)
gtsummary::theme_gtsummary_compact()
gtsummary::theme_gtsummary_eda()
df <- read_csv("CHD Data.csv")
theme_set(theme_base())
df <- na.omit(df)
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(0,1), labels = c('1', '2')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('non-smoker', 'smoker')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
df <- df |>
mutate(sex = as.factor(sex),
education = as.factor(education),
smoker = factor(smoker, levels = c(1,2), labels = c('non-smoker', 'smoker')),
stroke = as.factor(stroke),
diabetes = as.factor(diabetes),
HTN = as.factor(HTN),
CHD = as.factor(CHD))
tbl_summary(df, by = CHD, include = c(smoker, stroke, HTN)) %>%
add_p()
install.packages('kableExtra')
kable(sum_tab_cat, format = "latex", booktabs = TRUE, caption = "A Beautiful Table") %>%
kable_styling(latex_options = c("striped", "hold_position", "scale_down"))
library(pacman)
p_load(tidyverse, ROCR, ggplot2, readr, ggthemes, gtsummary, kableExtra)
gtsummary::theme_gtsummary_compact()
gtsummary::theme_gtsummary_eda()
kable(sum_tab_cat, format = "latex", booktabs = TRUE, caption = "A Beautiful Table") %>%
kable_styling(latex_options = c("striped", "hold_position", "scale_down"))
